#!/bin/bash
{{ if eq .chezmoi.os "darwin" -}}
# Add all taps
{{ range .packages.homebrew.essential.taps -}}
brew tap {{ . }}
{{ end -}}
# Install essential packages
brew bundle --file=/dev/stdin <<EOF
{{ range .packages.homebrew.essential.brews -}}
brew {{ . | quote }}
{{ end -}}
{{ range .packages.homebrew.essential.casks -}}
cask {{ . | quote }}
{{ end -}}

# Install large-apps only on personal machines
{{ if .personal -}}
{{ range .packages.homebrew.large_apps.brews -}}
brew {{ . | quote }}
{{ end -}}
{{ range .packages.homebrew.large_apps.casks -}}
cask {{ . | quote }}
{{ end -}}
{{ end -}}
EOF
{{ else if eq .chezmoi.os "linux" -}}
sudo apt update
{{ if .packages.apt -}}
sudo apt install -y {{ range .packages.apt }} \
  {{ . | quote }}{{ end }}
{{ end -}}
{{ end -}}
